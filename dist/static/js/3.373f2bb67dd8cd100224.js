webpackJsonp([3],{qyeZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("8bfa"),n=a("AIB4"),i=a("Amqo"),o=a("mtWM"),s=a.n(o),l=a("mw3O"),c=a.n(l),d=(a("zNUS"),void 0),h=[],g={data:function(){return this.getSchoolData(),{selectedOptions2:[],defaultProps:{children:"targetChildren",label:"targetDescription"},props:{value:"targetId",label:"targetDescription",children:"targetChildren",multiple:!0,checkStrictly:!0},dialogFormVisible:!1,newChild:{targetId:-1,targetDescription:"",targetShowType:"",targetChildren:[],targetRelevance:[],targetStatus:-1,targetOrigin:-1},formLabelWidth:"120px",labelPosition:"left",data:[],schoolExisted:null,checked:[],selfCreat:[],editFlag:!0,intervalId:0,currentChecked:{}}},components:{ElSelectDropdown:i.a,sideBarRouter:r.a,headBarRouter:n.a},methods:{Iteration:function(t){for(var e=0;e<h.length;++e){if(h[e].targetId===t)return h.splice(e,1).pop()}return null},DFSNode:function(t){for(var e=[],a=0;a<t.length;++a){var r=this.Iteration(t[a]);null!=r&&(1===r.targetStatus&&this.checked.push(r.targetId),r.targetChildren.length>0?e.push({targetId:r.targetId,targetDescription:r.targetDescription,targetRelevance:r.targetRelevance,targetOrigin:r.targetOrigin,targetStatus:r.targetStatus,targetChildren:this.DFSNode(r.targetChildren)}):e.push({targetId:r.targetId,targetDescription:r.targetDescription,targetRelevance:r.targetRelevance,targetOrigin:r.targetOrigin,targetStatus:r.targetStatus}))}return e},getSchoolData:function(){var t=this;console.log();var e=[];s.a.post("http://47.110.134.247/group2_b/schoolStandardDataForm/getData",c.a.stringify({schoolId:1})).then(function(a){for(h=a.data.data.target,t.schoolExisted=a.data.data.exist,d=h[h.length-1].targetId+1;h.length>0;){var r=[h[0].targetId];e.push(t.DFSNode(r).pop())}t.data=e})},DFStoArray:function(){var t=0,e=this.$refs.tree.getCheckedNodes();console.log(e);for(var a=[],r=0;r<e.length;++r){var n=e[r],i={targetId:n.targetId,targetDescription:n.targetDescription,targetChildren:[],showType:"",targetRelevance:[],targetStatus:n.targetStatus,targetOrigin:n.targetOrigin};if(n.targetChildren&&n.targetChildren.length>0)for(var o=0;o<n.targetChildren.length;++o)i.targetChildren.push(n.targetChildren[o].targetId);void 0!==n.targetRelevance&&null!==n.targetRelevance||(n.targetRelevance=[]),i.targetRelevance=n.targetRelevance,2===i.targetStatus?(t++,i.targetStatus=1,this.selfCreat.push(i),console.log("i am in ",t)):(i.targetStatus=1,a.push(i))}return a},editSchoolData:function(){var t=this.DFStoArray();if(console.log("新建的内容",this.selfCreat),this.$refs.tree.getCheckedNodes().length<=0)alert("请确保您的指标不为空");else{var e={schoolId:1,updateTarget:t,addTarget:this.selfCreat};s()({method:"post",url:"http://47.103.77.143/group2_b/schoolStandardDataForm/updateSchoolDataForm",contentType:"application/json;charset=UTF-8",data:e}).then(function(t){4===t.status&&alert("指标参数错误"),alert("指标创建"+t.data.message)}).catch(function(t){alert(t.response.data.message)})}},createSchoolData:function(){var t=this.DFStoArray().concat(this.selfCreat);console.log("原来保存的内容",this.DFStoArray()),console.log("新建的内容",this.selfCreat),console.log("全部的内容",t),this.$refs.tree.getCheckedNodes().length<=0?alert("请确保您选择的指标不为空"):s()({method:"post",url:"http://47.103.77.143/group2_b/schoolStandardDataForm/createSchoolDataForm",data:{schoolId:1,schoolData:t}}).then(function(t){4===t.status&&alert("指标参数错误"),alert("指标创建"+t.data.message)}).catch(function(t){alert(t.response.data.message)})},append:function(t,e){this.testEmpty()||(e.targetChildren||this.$set(e,"targetChildren",[]),this.converterRelevanceID(),e.targetChildren.push(this.getData()),console.log(e.targetChildren),this.newChild.targetId=this.newChild.targetDescription="",this.newChild.targetRelevance=[],this.selectedOptions2=[])},getData:function(){return{targetId:d++,targetDescription:this.newChild.targetDescription,targetRelevance:this.newChild.targetRelevance,targetStatus:2,targetOrigin:1}},remove:function(t,e){this.$set(e,"disabled",!0),this.$set(t,"checked",!1)},edit:function(t,e){this.newChild.targetDescription=e.targetDescription,this.selectedOptions2=e.targetRelevance,this.editFlag=!1},editConfirm:function(t,e){e.targetDescription=this.newChild.targetDescription,e.targetRelevance=this.newChild.targetRelevance,this.editFlag=!0},recover:function(t){this.$set(t,"disabled",!1)},getCheckedNodes:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log("chosenList is:"),console.log(this.$refs.tree.getCheckedNodes(!0))},getCheckedKeys:function(){console.log(this.$refs.tree.getCheckedKeys())},setCheckedNodes:function(){this.$refs.tree.setCheckedNodes([{id:5},{id:9}])},packageOne:function(){this.$refs.tree.setCheckedKeys([4,7,22,25,26,13,14,16])},packageTwo:function(){this.$refs.tree.setCheckedKeys([8,18,19,14,15,16])},handleCheckChange:function(){console.log("Hi")},resetChecked:function(){this.$refs.tree.setCheckedKeys([])},handleChange:function(t){this.newChild.targetRelevance=t},converterRelevanceID:function(){var t=this,e=this.newChild.targetRelevance;this.newChild.targetRelevance=[],e.forEach(function(e){t.newChild.targetRelevance.push(e.pop())})},testEmpty:function(){return!this.newChild.targetDescription&&(this.$alert("指标不可为空！"),!0)},renderContent:function(t,e){var a=this,r=e.node,n=e.data;e.store;return t("span",{class:"custom-tree-node"},[t("span",[r.label]),t("span",[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.append(r,n)}}},["添加"]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.remove(r,n)}}},["删除"]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.edit(r,n)}}},["修改"]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.editConfirm(r,n)}}},["确认修改"]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.recover(n)}}},["恢复"])])])}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-container",{staticStyle:{position:"absolute",top:"0",bottom:"0",left:"0",width:"100%"},attrs:{direction:"vertical"}},[a("el-header",{staticStyle:{height:"82px",background:"#f1f2f7"}},[a("head-bar-router")],1),t._v(" "),a("el-container",[a("el-aside",{attrs:{width:"211px"}},[a("side-bar-router")],1),t._v(" "),a("el-main",{staticClass:"el-main"},[a("el-container",[a("el-header",{staticStyle:{"text-align":"center"}},[t._v("指标选择")]),t._v(" "),[a("div",{staticClass:"custom-tree-container"},[a("div",{staticClass:"block"},[a("el-tree",{ref:"tree",attrs:{"default-checked-keys":t.checked,data:t.data,"show-checkbox":"","node-key":"targetId",accordion:"","expand-on-click-node":!1,"highlight-current":"",props:t.defaultProps,"render-content":t.renderContent},on:{change:t.handleCheckChange}}),t._v(" "),a("div",{staticClass:"add"},[a("el-form",{model:{value:t.newChild,callback:function(e){t.newChild=e},expression:"newChild"}},[a("el-form-item",[a("el-button",{staticClass:"textButton",attrs:{type:"text"},on:{click:function(t){t.preventDefault()}}},[t._v("先在下方输入，再在上方需要的地方点击添加")])],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-left":"0"},attrs:{label:"指标关联","label-width":t.formLabelWidth}},[a("el-cascader",{staticClass:"cas",attrs:{size:"medium",options:t.data,props:t.props},on:{change:t.handleChange},model:{value:t.selectedOptions2,callback:function(e){t.selectedOptions2=e},expression:"selectedOptions2"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-left":"0"},attrs:{label:"指标描述","label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入指标"},model:{value:t.newChild.targetDescription,callback:function(e){t.$set(t.newChild,"targetDescription",e)},expression:"newChild.targetDescription"}})],1),t._v(" "),a("el-form-item",[!0===t.schoolExisted?a("el-button",{staticClass:"textButton",attrs:{type:"primary"},on:{click:t.editSchoolData}},[t._v("修改")]):t._e(),t._v(" "),!1===t.schoolExisted?a("el-button",{staticClass:"textButton",attrs:{type:"primary"},on:{click:t.createSchoolData}},[t._v("新建")]):t._e(),t._v(" "),null===t.schoolExisted?a("el-button",{staticClass:"textButton",attrs:{type:"danger"},on:{click:function(t){t.preventDefault()}}},[t._v("请联系管理员！")]):t._e(),t._v(" "),a("el-button",{on:{click:t.resetChecked}},[t._v("清空所选项")])],1)],1)],1),t._v(" "),a("el-main"),t._v(" "),a("el-main")],1)])]],2)],1)],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(g,u,!1,function(t){a("tHxF")},null,null);e.default=p.exports},tHxF:function(t,e){}});
//# sourceMappingURL=3.373f2bb67dd8cd100224.js.map